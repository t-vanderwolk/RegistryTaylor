2025-11-05 14:11:29.398 MST [8856] LOG:  starting PostgreSQL 16.10 (Homebrew) on aarch64-apple-darwin24.4.0, compiled by Apple clang version 17.0.0 (clang-1700.0.13.3), 64-bit
2025-11-05 14:11:29.400 MST [8856] LOG:  listening on IPv6 address "::1", port 5432
2025-11-05 14:11:29.400 MST [8856] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2025-11-05 14:11:29.400 MST [8856] LOG:  listening on Unix socket "/tmp/.s.PGSQL.5432"
2025-11-05 14:11:29.402 MST [8859] LOG:  database system was shut down at 2025-11-05 14:10:12 MST
2025-11-05 14:11:29.405 MST [8856] LOG:  database system is ready to accept connections
2025-11-05 14:11:46.886 MST [8970] FATAL:  role "postgres" does not exist
2025-11-05 14:13:24.776 MST [9329] ERROR:  role "postgres" already exists
2025-11-05 14:13:24.776 MST [9329] STATEMENT:  CREATE ROLE postgres WITH LOGIN SUPERUSER PASSWORD 'this_is_my_super_secret_password';
2025-11-05 14:14:29.609 MST [9830] FATAL:  database "registry_taylor" does not exist
2025-11-05 14:14:29.610 MST [9831] FATAL:  database "registry_taylor" does not exist
2025-11-05 14:14:29.621 MST [9833] FATAL:  database "registry_taylor" does not exist
2025-11-05 14:14:29.622 MST [9834] FATAL:  database "registry_taylor" does not exist
2025-11-05 14:14:29.735 MST [9839] ERROR:  relation "_prisma_migrations" does not exist at character 126
2025-11-05 14:14:29.735 MST [9839] STATEMENT:  SELECT "id", "checksum", "finished_at", "migration_name", "logs", "rolled_back_at", "started_at", "applied_steps_count" FROM "_prisma_migrations" ORDER BY "started_at" ASC
2025-11-05 14:14:29.800 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-05 14:14:29.844 MST [8857] LOG:  checkpoint complete: wrote 1000 buffers (6.1%); 1 WAL file(s) added, 0 removed, 0 recycled; write=0.033 s, sync=0.008 s, total=0.045 s; sync files=317, longest=0.001 s, average=0.001 s; distance=9011 kB, estimate=9011 kB; lsn=0/1DE66B8, redo lsn=0/1DE6680
2025-11-05 14:14:30.072 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-05 14:14:30.074 MST [8857] LOG:  checkpoint complete: wrote 10 buffers (0.1%); 0 WAL file(s) added, 0 removed, 1 recycled; write=0.001 s, sync=0.001 s, total=0.003 s; sync files=8, longest=0.001 s, average=0.001 s; distance=4911 kB, estimate=8601 kB; lsn=0/22B2658, redo lsn=0/22B2620
2025-11-05 14:14:30.222 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-05 14:14:30.228 MST [8857] LOG:  checkpoint complete: wrote 132 buffers (0.8%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.002 s, sync=0.004 s, total=0.007 s; sync files=155, longest=0.001 s, average=0.001 s; distance=5692 kB, estimate=8310 kB; lsn=0/2841660, redo lsn=0/2841628
2025-11-05 14:19:30.227 MST [8857] LOG:  checkpoint starting: time
2025-11-05 14:19:37.874 MST [8857] LOG:  checkpoint complete: wrote 76 buffers (0.5%); 0 WAL file(s) added, 0 removed, 0 recycled; write=7.642 s, sync=0.002 s, total=7.648 s; sync files=29, longest=0.001 s, average=0.001 s; distance=275 kB, estimate=7506 kB; lsn=0/2886640, redo lsn=0/2886608
2025-11-05 14:24:30.887 MST [8857] LOG:  checkpoint starting: time
2025-11-05 14:24:39.520 MST [8857] LOG:  checkpoint complete: wrote 86 buffers (0.5%); 0 WAL file(s) added, 0 removed, 0 recycled; write=8.625 s, sync=0.003 s, total=8.633 s; sync files=52, longest=0.001 s, average=0.001 s; distance=172 kB, estimate=6773 kB; lsn=0/28B1A10, redo lsn=0/28B19D8
2025-11-05 14:29:30.520 MST [8857] LOG:  checkpoint starting: time
2025-11-05 14:29:33.064 MST [8857] LOG:  checkpoint complete: wrote 26 buffers (0.2%); 0 WAL file(s) added, 0 removed, 0 recycled; write=2.538 s, sync=0.003 s, total=2.545 s; sync files=15, longest=0.001 s, average=0.001 s; distance=97 kB, estimate=6105 kB; lsn=0/28CA070, redo lsn=0/28CA038
2025-11-05 14:34:30.064 MST [8857] LOG:  checkpoint starting: time
2025-11-05 14:34:30.684 MST [8857] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.617 s, sync=0.002 s, total=0.620 s; sync files=7, longest=0.001 s, average=0.001 s; distance=10 kB, estimate=5496 kB; lsn=0/28CCAB8, redo lsn=0/28CCA80
2025-11-05 22:08:59.555 MST [8857] LOG:  checkpoint starting: time
2025-11-05 22:09:00.375 MST [8857] LOG:  checkpoint complete: wrote 8 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.814 s, sync=0.001 s, total=0.825 s; sync files=8, longest=0.001 s, average=0.001 s; distance=7 kB, estimate=4947 kB; lsn=0/28CE9D0, redo lsn=0/28CE998
2025-11-05 22:13:59.373 MST [8857] LOG:  checkpoint starting: time
2025-11-05 22:13:59.893 MST [8857] LOG:  checkpoint complete: wrote 6 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.509 s, sync=0.002 s, total=0.520 s; sync files=6, longest=0.001 s, average=0.001 s; distance=11 kB, estimate=4453 kB; lsn=0/28D1750, redo lsn=0/28D1718
2025-11-05 22:38:59.895 MST [8857] LOG:  checkpoint starting: time
2025-11-05 22:39:01.035 MST [8857] LOG:  checkpoint complete: wrote 12 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.134 s, sync=0.002 s, total=1.140 s; sync files=12, longest=0.001 s, average=0.001 s; distance=3 kB, estimate=4008 kB; lsn=0/28D2508, redo lsn=0/28D24D0
2025-11-05 22:51:04.073 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-05 22:51:04.076 MST [8857] LOG:  checkpoint complete: wrote 13 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.002 s, sync=0.001 s, total=0.003 s; sync files=13, longest=0.001 s, average=0.001 s; distance=4899 kB, estimate=4899 kB; lsn=0/2D9B1F8, redo lsn=0/2D9B1C0
2025-11-05 22:51:04.205 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-05 22:51:04.210 MST [8857] LOG:  checkpoint complete: wrote 25 buffers (0.2%); 0 WAL file(s) added, 0 removed, 1 recycled; write=0.004 s, sync=0.001 s, total=0.005 s; sync files=16, longest=0.001 s, average=0.001 s; distance=4937 kB, estimate=4937 kB; lsn=0/326D7F8, redo lsn=0/326D7C0
2025-11-05 22:51:06.157 MST [85997] ERROR:  relation "public.Quiz" does not exist at character 13
2025-11-05 22:51:06.157 MST [85997] STATEMENT:  DELETE FROM "public"."Quiz" WHERE 1=1
2025-11-05 22:56:04.210 MST [8857] LOG:  checkpoint starting: time
2025-11-05 22:56:05.129 MST [8857] LOG:  checkpoint complete: wrote 10 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.915 s, sync=0.002 s, total=0.919 s; sync files=9, longest=0.001 s, average=0.001 s; distance=22 kB, estimate=4445 kB; lsn=0/3273110, redo lsn=0/32730D8
2025-11-06 06:38:43.577 MST [8857] LOG:  checkpoint starting: immediate force wait time
2025-11-06 06:38:43.581 MST [8857] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.002 s, sync=0.001 s, total=0.004 s; sync files=7, longest=0.001 s, average=0.001 s; distance=4906 kB, estimate=4906 kB; lsn=0/373DA78, redo lsn=0/373DA40
2025-11-06 06:38:43.708 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 06:38:43.710 MST [8857] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.001 s, sync=0.001 s, total=0.002 s; sync files=7, longest=0.001 s, average=0.001 s; distance=4909 kB, estimate=4909 kB; lsn=0/3C090B8, redo lsn=0/3C09080
2025-11-06 06:38:45.327 MST [92944] ERROR:  relation "public.Quiz" does not exist at character 13
2025-11-06 06:38:45.327 MST [92944] STATEMENT:  DELETE FROM "public"."Quiz" WHERE 1=1
2025-11-06 06:41:35.307 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 06:41:35.310 MST [8857] LOG:  checkpoint complete: wrote 10 buffers (0.1%); 0 WAL file(s) added, 0 removed, 1 recycled; write=0.002 s, sync=0.001 s, total=0.004 s; sync files=10, longest=0.001 s, average=0.001 s; distance=4922 kB, estimate=4922 kB; lsn=0/40D7A20, redo lsn=0/40D79E8
2025-11-06 06:41:35.438 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 06:41:35.439 MST [8857] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.001 s, sync=0.001 s, total=0.002 s; sync files=7, longest=0.001 s, average=0.001 s; distance=4905 kB, estimate=4920 kB; lsn=0/45A21B0, redo lsn=0/45A2178
2025-11-06 06:46:35.441 MST [8857] LOG:  checkpoint starting: time
2025-11-06 06:46:36.267 MST [8857] LOG:  checkpoint complete: wrote 9 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.820 s, sync=0.001 s, total=0.826 s; sync files=9, longest=0.001 s, average=0.001 s; distance=34 kB, estimate=4432 kB; lsn=0/45AA9D0, redo lsn=0/45AA998
2025-11-06 06:47:06.982 MST [95990] ERROR:  column "userId" of relation "AcademyProgress" contains null values
2025-11-06 06:47:06.982 MST [95990] STATEMENT:  /*
	  Warnings:
	
	  - The primary key for the `AcademyModule` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `AcademyModule` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `AcademyProgress` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `AcademyProgress` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `Profile` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `Profile` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The `mentorId` column on the `Profile` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `Questionnaire` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `Questionnaire` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The `mentorId` column on the `RegistryNote` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `User` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `User` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - Changed the type of `userId` on the `AcademyProgress` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `moduleId` on the `AcademyProgress` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `authorId` on the `Announcement` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `authorId` on the `Comment` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `authorId` on the `CommunityPost` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `createdById` on the `Event` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `EventRsvp` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `senderId` on the `Message` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `receiverId` on the `Message` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `Profile` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `Questionnaire` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `RegistryItem` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `memberId` on the `WorkbookEntry` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	
	*/
	-- DropForeignKey
	ALTER TABLE "public"."AcademyProgress" DROP CONSTRAINT "AcademyProgress_moduleId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."AcademyProgress" DROP CONSTRAINT "AcademyProgress_userId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Announcement" DROP CONSTRAINT "Announcement_authorId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Comment" DROP CONSTRAINT "Comment_authorId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."CommunityPost" DROP CONSTRAINT "CommunityPost_authorId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Event" DROP CONSTRAINT "Event_createdById_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."EventRsvp" DROP CONSTRAINT "EventRsvp_eventId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."EventRsvp" DROP CONSTRAINT "EventRsvp_userId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Message" DROP CONSTRAINT "Message_receiverId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Message" DROP CONSTRAINT "Message_senderId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Profile" DROP CONSTRAINT "Profile_mentorId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Profile" DROP CONSTRAINT "Profile_userId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Questionnaire" DROP CONSTRAINT "Questionnaire_userId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."RegistryItem" DROP CONSTRAINT "RegistryItem_userId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."RegistryNote" DROP CONSTRAINT "RegistryNote_mentorId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."WorkbookEntry" DROP CONSTRAINT "WorkbookEntry_memberId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."WorkbookEntry" DROP CONSTRAINT "WorkbookEntry_moduleSlug_fkey";
	
	-- AlterTable
	ALTER TABLE "AcademyModule" DROP CONSTRAINT "AcademyModule_pkey",
	ADD COLUMN     "subtitle" TEXT,
	DROP COLUMN "id",
	ADD COLUMN     "id" SERIAL NOT NULL,
	ALTER COLUMN "content" SET DATA TYPE TEXT,
	ALTER COLUMN "summary" DROP NOT NULL,
	ALTER COLUMN "summary" DROP DEFAULT,
	ALTER COLUMN "category" DROP NOT NULL,
	ALTER COLUMN "category" DROP DEFAULT,
	ALTER COLUMN "lecture" DROP NOT NULL,
	ALTER COLUMN "lecture" DROP DEFAULT,
	ALTER COLUMN "order" DROP NOT NULL,
	ALTER COLUMN "order" DROP DEFAULT,
	ALTER COLUMN "workbookPrompt" DROP NOT NULL,
	ALTER COLUMN "workbookPrompt" DROP DEFAULT,
	ADD CONSTRAINT "AcademyModule_pkey" PRIMARY KEY ("id");
	
	-- AlterTable
	ALTER TABLE "AcademyProgress" DROP CONSTRAINT "AcademyProgress_pkey",
	ADD COLUMN     "completed" BOOLEAN NOT NULL DEFAULT false,
	ADD COLUMN     "quizScore" INTEGER,
	ADD COLUMN     "reflection" TEXT,
	DROP COLUMN "id",
	ADD COLUMN     "id" SERIAL NOT NULL,
	DROP COLUMN "userId",
	ADD COLUMN     "userId" INTEGER NOT NULL,
	DROP COLUMN "moduleId",
	ADD COLUMN     "moduleId" INTEGER NOT NULL,
	ADD CONSTRAINT "AcademyProgress_pkey" PRIMARY KEY ("id");
	
	-- AlterTable
	ALTER TABLE "Announcement" DROP COLUMN "authorId",
	ADD COLUMN     "authorId" INTEGER NOT NULL;
	
	-- AlterTable
	ALTER TABLE "Comment" DROP COLUMN "authorId",
	ADD COLUMN     "authorId" INTEGER NOT NULL;
	
	-- AlterTable
	ALTER TABLE "CommunityPost" DROP COLUMN "authorId",
	ADD COLUMN     "authorId" INTEGER NOT NULL;
	
	-- AlterTable
	ALTER TABLE "Event" DROP COLUMN "createdById",
	ADD COLUMN     "createdById" INTEGER NOT NULL;
	
	-- AlterTable
	ALTER TABLE "EventRsvp" DROP COLUMN "userId",
	ADD COLUMN     "userId" INTEGER NOT NULL;
	
	-- AlterTable
	ALTER TABLE "Message" DROP COLUMN "senderId",
	ADD COLUMN     "senderId" INTEGER NOT NULL,
	DROP COLUMN "receiverId",
	ADD COLUMN     "receiverId" INTEGER NOT NULL;
	
	-- AlterTable
	ALTER TABLE "Profile" DROP CONSTRAINT "Profile_pkey",
	DROP COLUMN "id",
	ADD COLUMN     "id" SERIAL NOT NULL,
	DROP COLUMN "userId",
	ADD COLUMN     "userId" INTEGER NOT NULL,
	DROP COLUMN "mentorId",
	ADD COLUMN     "mentorId" INTEGER,
	ADD CONSTRAINT "Profile_pkey" PRIMARY KEY ("id");
	
	-- AlterTable
	ALTER TABLE "Questionnaire" DROP CONSTRAINT "Questionnaire_pkey",
	DROP COLUMN "id",
	ADD COLUMN     "id" SERIAL NOT NULL,
	DROP COLUMN "userId",
	ADD COLUMN     "userId" INTEGER NOT NULL,
	ADD CONSTRAINT "Questionnaire_pkey" PRIMARY KEY ("id");
	
	-- AlterTable
	ALTER TABLE "RegistryItem" DROP COLUMN "userId",
	ADD COLUMN     "userId" INTEGER NOT NULL;
	
	-- AlterTable
	ALTER TABLE "RegistryNote" DROP COLUMN "mentorId",
	ADD COLUMN     "mentorId" INTEGER;
	
	-- AlterTable
	ALTER TABLE "User" DROP CONSTRAINT "User_pkey",
	DROP COLUMN "id",
	ADD COLUMN     "id" SERIAL NOT NULL,
	ADD CONSTRAINT "User_pkey" PRIMARY KEY ("id");
	
	-- AlterTable
	ALTER TABLE "WorkbookEntry" DROP COLUMN "memberId",
	ADD COLUMN     "memberId" INTEGER NOT NULL;
	
	-- CreateTable
	CREATE TABLE "Quiz" (
	    "id" SERIAL NOT NULL,
	    "moduleId" INTEGER NOT NULL,
	    "userId" INTEGER,
	    "question" TEXT NOT NULL,
	    "options" TEXT[],
	    "answer" TEXT NOT NULL,
	    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
	    "updatedAt" TIMESTAMP(3) NOT NULL,
	
	    CONSTRAINT "Quiz_pkey" PRIMARY KEY ("id")
	);
	
	-- CreateIndex
	CREATE INDEX "Quiz_moduleId_idx" ON "Quiz"("moduleId");
	
	-- CreateIndex
	CREATE INDEX "Quiz_userId_idx" ON "Quiz"("userId");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "Quiz_moduleId_question_key" ON "Quiz"("moduleId", "question");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "AcademyProgress_userId_moduleId_key" ON "AcademyProgress"("userId", "moduleId");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "EventRsvp_eventId_userId_key" ON "EventRsvp"("eventId", "userId");
	
	-- CreateIndex
	CREATE INDEX "Message_senderId_idx" ON "Message"("senderId");
	
	-- CreateIndex
	CREATE INDEX "Message_receiverId_idx" ON "Message"("receiverId");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "Profile_userId_key" ON "Profile"("userId");
	
	-- CreateIndex
	CREATE INDEX "Profile_mentorId_idx" ON "Profile"("mentorId");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "Questionnaire_userId_key" ON "Questionnaire"("userId");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "RegistryItem_externalId_userId_key" ON "RegistryItem"("externalId", "userId");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "RegistryNote_registryItemId_mentorId_key" ON "RegistryNote"("registryItemId", "mentorId");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "WorkbookEntry_memberId_moduleSlug_key" ON "WorkbookEntry"("memberId", "moduleSlug");
	
	-- AddForeignKey
	ALTER TABLE "Profile" ADD CONSTRAINT "Profile_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Profile" ADD CONSTRAINT "Profile_mentorId_fkey" FOREIGN KEY ("mentorId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Questionnaire" ADD CONSTRAINT "Questionnaire_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "AcademyProgress" ADD CONSTRAINT "AcademyProgress_moduleId_fkey" FOREIGN KEY ("moduleId") REFERENCES "AcademyModule"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "AcademyProgress" ADD CONSTRAINT "AcademyProgress_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Quiz" ADD CONSTRAINT "Quiz_moduleId_fkey" FOREIGN KEY ("moduleId") REFERENCES "AcademyModule"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Quiz" ADD CONSTRAINT "Quiz_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "RegistryItem" ADD CONSTRAINT "RegistryItem_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "RegistryNote" ADD CONSTRAINT "RegistryNote_mentorId_fkey" FOREIGN KEY ("mentorId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "CommunityPost" ADD CONSTRAINT "CommunityPost_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Comment" ADD CONSTRAINT "Comment_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Event" ADD CONSTRAINT "Event_createdById_fkey" FOREIGN KEY ("createdById") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "EventRsvp" ADD CONSTRAINT "EventRsvp_eventId_fkey" FOREIGN KEY ("eventId") REFERENCES "Event"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "EventRsvp" ADD CONSTRAINT "EventRsvp_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "WorkbookEntry" ADD CONSTRAINT "WorkbookEntry_memberId_fkey" FOREIGN KEY ("memberId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "WorkbookEntry" ADD CONSTRAINT "WorkbookEntry_moduleSlug_fkey" FOREIGN KEY ("moduleSlug") REFERENCES "AcademyModule"("slug") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Announcement" ADD CONSTRAINT "Announcement_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Message" ADD CONSTRAINT "Message_senderId_fkey" FOREIGN KEY ("senderId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Message" ADD CONSTRAINT "Message_receiverId_fkey" FOREIGN KEY ("receiverId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	ALTER TABLE "User"
	  ALTER COLUMN "id" TYPE integer USING "id"::integer;
	
	ALTER TABLE "Profile"
	  ALTER COLUMN "userId" TYPE integer USING "userId"::integer,
	  ALTER COLUMN "mentorId" TYPE integer USING "mentorId"::integer;
	
	ALTER TABLE "Questionnaire"
	  ALTER COLUMN "userId" TYPE integer USING "userId"::integer;
	
	ALTER TABLE "AcademyProgress"
	  ALTER COLUMN "userId" TYPE integer USING "userId"::integer,
	  ALTER COLUMN "moduleId" TYPE integer USING "moduleId"::integer;
2025-11-06 06:51:35.269 MST [8857] LOG:  checkpoint starting: time
2025-11-06 06:51:42.183 MST [8857] LOG:  checkpoint complete: wrote 69 buffers (0.4%); 0 WAL file(s) added, 0 removed, 0 recycled; write=6.907 s, sync=0.004 s, total=6.915 s; sync files=50, longest=0.001 s, average=0.001 s; distance=452 kB, estimate=4034 kB; lsn=0/461BB40, redo lsn=0/461BB08
2025-11-06 06:54:02.147 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 06:54:02.150 MST [8857] LOG:  checkpoint complete: wrote 8 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.002 s, sync=0.001 s, total=0.003 s; sync files=8, longest=0.001 s, average=0.001 s; distance=4910 kB, estimate=4910 kB; lsn=0/4AE7350, redo lsn=0/4AE7318
2025-11-06 06:54:02.294 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 06:54:02.299 MST [8857] LOG:  checkpoint complete: wrote 32 buffers (0.2%); 0 WAL file(s) added, 0 removed, 1 recycled; write=0.004 s, sync=0.001 s, total=0.005 s; sync files=19, longest=0.001 s, average=0.001 s; distance=5393 kB, estimate=5393 kB; lsn=0/502B9F8, redo lsn=0/502B9C0
2025-11-06 06:54:02.327 MST [98942] ERROR:  column "userId" of relation "AcademyProgress" contains null values
2025-11-06 06:54:02.327 MST [98942] STATEMENT:  /*
	  Warnings:
	
	  - The primary key for the `AcademyModule` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `AcademyModule` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `AcademyProgress` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `AcademyProgress` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `Profile` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `Profile` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The `mentorId` column on the `Profile` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `Questionnaire` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `Questionnaire` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The `mentorId` column on the `RegistryNote` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `User` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `User` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - Changed the type of `userId` on the `AcademyProgress` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `moduleId` on the `AcademyProgress` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `authorId` on the `Announcement` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `authorId` on the `Comment` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `authorId` on the `CommunityPost` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `createdById` on the `Event` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `EventRsvp` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `senderId` on the `Message` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `receiverId` on the `Message` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `Profile` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `Questionnaire` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `RegistryItem` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `memberId` on the `WorkbookEntry` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	
	*/
	-- DropForeignKey
	ALTER TABLE "public"."AcademyProgress" DROP CONSTRAINT "AcademyProgress_moduleId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."AcademyProgress" DROP CONSTRAINT "AcademyProgress_userId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Announcement" DROP CONSTRAINT "Announcement_authorId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Comment" DROP CONSTRAINT "Comment_authorId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."CommunityPost" DROP CONSTRAINT "CommunityPost_authorId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Event" DROP CONSTRAINT "Event_createdById_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."EventRsvp" DROP CONSTRAINT "EventRsvp_eventId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."EventRsvp" DROP CONSTRAINT "EventRsvp_userId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Message" DROP CONSTRAINT "Message_receiverId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Message" DROP CONSTRAINT "Message_senderId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Profile" DROP CONSTRAINT "Profile_mentorId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Profile" DROP CONSTRAINT "Profile_userId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."Questionnaire" DROP CONSTRAINT "Questionnaire_userId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."RegistryItem" DROP CONSTRAINT "RegistryItem_userId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."RegistryNote" DROP CONSTRAINT "RegistryNote_mentorId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."WorkbookEntry" DROP CONSTRAINT "WorkbookEntry_memberId_fkey";
	
	-- DropForeignKey
	ALTER TABLE "public"."WorkbookEntry" DROP CONSTRAINT "WorkbookEntry_moduleSlug_fkey";
	
	-- AlterTable
	ALTER TABLE "AcademyModule" DROP CONSTRAINT "AcademyModule_pkey",
	ADD COLUMN     "subtitle" TEXT,
	DROP COLUMN "id",
	ADD COLUMN     "id" SERIAL NOT NULL,
	ALTER COLUMN "content" SET DATA TYPE TEXT,
	ALTER COLUMN "summary" DROP NOT NULL,
	ALTER COLUMN "summary" DROP DEFAULT,
	ALTER COLUMN "category" DROP NOT NULL,
	ALTER COLUMN "category" DROP DEFAULT,
	ALTER COLUMN "lecture" DROP NOT NULL,
	ALTER COLUMN "lecture" DROP DEFAULT,
	ALTER COLUMN "order" DROP NOT NULL,
	ALTER COLUMN "order" DROP DEFAULT,
	ALTER COLUMN "workbookPrompt" DROP NOT NULL,
	ALTER COLUMN "workbookPrompt" DROP DEFAULT,
	ADD CONSTRAINT "AcademyModule_pkey" PRIMARY KEY ("id");
	
	-- AlterTable
	ALTER TABLE "AcademyProgress" DROP CONSTRAINT "AcademyProgress_pkey",
	ADD COLUMN     "completed" BOOLEAN NOT NULL DEFAULT false,
	ADD COLUMN     "quizScore" INTEGER,
	ADD COLUMN     "reflection" TEXT,
	DROP COLUMN "id",
	ADD COLUMN     "id" SERIAL NOT NULL,
	DROP COLUMN "userId",
	ADD COLUMN     "userId" INTEGER NOT NULL,
	DROP COLUMN "moduleId",
	ADD COLUMN     "moduleId" INTEGER NOT NULL,
	ADD CONSTRAINT "AcademyProgress_pkey" PRIMARY KEY ("id");
	
	-- AlterTable
	ALTER TABLE "Announcement" DROP COLUMN "authorId",
	ADD COLUMN     "authorId" INTEGER NOT NULL;
	
	-- AlterTable
	ALTER TABLE "Comment" DROP COLUMN "authorId",
	ADD COLUMN     "authorId" INTEGER NOT NULL;
	
	-- AlterTable
	ALTER TABLE "CommunityPost" DROP COLUMN "authorId",
	ADD COLUMN     "authorId" INTEGER NOT NULL;
	
	-- AlterTable
	ALTER TABLE "Event" DROP COLUMN "createdById",
	ADD COLUMN     "createdById" INTEGER NOT NULL;
	
	-- AlterTable
	ALTER TABLE "EventRsvp" DROP COLUMN "userId",
	ADD COLUMN     "userId" INTEGER NOT NULL;
	
	-- AlterTable
	ALTER TABLE "Message" DROP COLUMN "senderId",
	ADD COLUMN     "senderId" INTEGER NOT NULL,
	DROP COLUMN "receiverId",
	ADD COLUMN     "receiverId" INTEGER NOT NULL;
	
	-- AlterTable
	ALTER TABLE "Profile" DROP CONSTRAINT "Profile_pkey",
	DROP COLUMN "id",
	ADD COLUMN     "id" SERIAL NOT NULL,
	DROP COLUMN "userId",
	ADD COLUMN     "userId" INTEGER NOT NULL,
	DROP COLUMN "mentorId",
	ADD COLUMN     "mentorId" INTEGER,
	ADD CONSTRAINT "Profile_pkey" PRIMARY KEY ("id");
	
	-- AlterTable
	ALTER TABLE "Questionnaire" DROP CONSTRAINT "Questionnaire_pkey",
	DROP COLUMN "id",
	ADD COLUMN     "id" SERIAL NOT NULL,
	DROP COLUMN "userId",
	ADD COLUMN     "userId" INTEGER NOT NULL,
	ADD CONSTRAINT "Questionnaire_pkey" PRIMARY KEY ("id");
	
	-- AlterTable
	ALTER TABLE "RegistryItem" DROP COLUMN "userId",
	ADD COLUMN     "userId" INTEGER NOT NULL;
	
	-- AlterTable
	ALTER TABLE "RegistryNote" DROP COLUMN "mentorId",
	ADD COLUMN     "mentorId" INTEGER;
	
	-- AlterTable
	ALTER TABLE "User" DROP CONSTRAINT "User_pkey",
	DROP COLUMN "id",
	ADD COLUMN     "id" SERIAL NOT NULL,
	ADD CONSTRAINT "User_pkey" PRIMARY KEY ("id");
	
	-- AlterTable
	ALTER TABLE "WorkbookEntry" DROP COLUMN "memberId",
	ADD COLUMN     "memberId" INTEGER NOT NULL;
	
	-- CreateTable
	CREATE TABLE "Quiz" (
	    "id" SERIAL NOT NULL,
	    "moduleId" INTEGER NOT NULL,
	    "userId" INTEGER,
	    "question" TEXT NOT NULL,
	    "options" TEXT[],
	    "answer" TEXT NOT NULL,
	    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
	    "updatedAt" TIMESTAMP(3) NOT NULL,
	
	    CONSTRAINT "Quiz_pkey" PRIMARY KEY ("id")
	);
	
	-- CreateIndex
	CREATE INDEX "Quiz_moduleId_idx" ON "Quiz"("moduleId");
	
	-- CreateIndex
	CREATE INDEX "Quiz_userId_idx" ON "Quiz"("userId");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "Quiz_moduleId_question_key" ON "Quiz"("moduleId", "question");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "AcademyProgress_userId_moduleId_key" ON "AcademyProgress"("userId", "moduleId");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "EventRsvp_eventId_userId_key" ON "EventRsvp"("eventId", "userId");
	
	-- CreateIndex
	CREATE INDEX "Message_senderId_idx" ON "Message"("senderId");
	
	-- CreateIndex
	CREATE INDEX "Message_receiverId_idx" ON "Message"("receiverId");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "Profile_userId_key" ON "Profile"("userId");
	
	-- CreateIndex
	CREATE INDEX "Profile_mentorId_idx" ON "Profile"("mentorId");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "Questionnaire_userId_key" ON "Questionnaire"("userId");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "RegistryItem_externalId_userId_key" ON "RegistryItem"("externalId", "userId");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "RegistryNote_registryItemId_mentorId_key" ON "RegistryNote"("registryItemId", "mentorId");
	
	-- CreateIndex
	CREATE UNIQUE INDEX "WorkbookEntry_memberId_moduleSlug_key" ON "WorkbookEntry"("memberId", "moduleSlug");
	
	-- AddForeignKey
	ALTER TABLE "Profile" ADD CONSTRAINT "Profile_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Profile" ADD CONSTRAINT "Profile_mentorId_fkey" FOREIGN KEY ("mentorId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Questionnaire" ADD CONSTRAINT "Questionnaire_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "AcademyProgress" ADD CONSTRAINT "AcademyProgress_moduleId_fkey" FOREIGN KEY ("moduleId") REFERENCES "AcademyModule"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "AcademyProgress" ADD CONSTRAINT "AcademyProgress_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Quiz" ADD CONSTRAINT "Quiz_moduleId_fkey" FOREIGN KEY ("moduleId") REFERENCES "AcademyModule"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Quiz" ADD CONSTRAINT "Quiz_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "RegistryItem" ADD CONSTRAINT "RegistryItem_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "RegistryNote" ADD CONSTRAINT "RegistryNote_mentorId_fkey" FOREIGN KEY ("mentorId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "CommunityPost" ADD CONSTRAINT "CommunityPost_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Comment" ADD CONSTRAINT "Comment_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Event" ADD CONSTRAINT "Event_createdById_fkey" FOREIGN KEY ("createdById") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "EventRsvp" ADD CONSTRAINT "EventRsvp_eventId_fkey" FOREIGN KEY ("eventId") REFERENCES "Event"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "EventRsvp" ADD CONSTRAINT "EventRsvp_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "WorkbookEntry" ADD CONSTRAINT "WorkbookEntry_memberId_fkey" FOREIGN KEY ("memberId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "WorkbookEntry" ADD CONSTRAINT "WorkbookEntry_moduleSlug_fkey" FOREIGN KEY ("moduleSlug") REFERENCES "AcademyModule"("slug") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Announcement" ADD CONSTRAINT "Announcement_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Message" ADD CONSTRAINT "Message_senderId_fkey" FOREIGN KEY ("senderId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	-- AddForeignKey
	ALTER TABLE "Message" ADD CONSTRAINT "Message_receiverId_fkey" FOREIGN KEY ("receiverId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
	ALTER TABLE "User"
	  ALTER COLUMN "id" TYPE integer USING "id"::integer;
	
	ALTER TABLE "Profile"
	  ALTER COLUMN "userId" TYPE integer USING "userId"::integer,
	  ALTER COLUMN "mentorId" TYPE integer USING "mentorId"::integer;
	
	ALTER TABLE "Questionnaire"
	  ALTER COLUMN "userId" TYPE integer USING "userId"::integer;
	
	ALTER TABLE "AcademyProgress"
	  ALTER COLUMN "userId" TYPE integer USING "userId"::integer,
	  ALTER COLUMN "moduleId" TYPE integer USING "moduleId"::integer;
2025-11-06 06:56:07.719 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 06:56:07.730 MST [8857] LOG:  checkpoint complete: wrote 82 buffers (0.5%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.009 s, sync=0.002 s, total=0.012 s; sync files=57, longest=0.001 s, average=0.001 s; distance=5416 kB, estimate=5416 kB; lsn=0/5575C38, redo lsn=0/5575C00
2025-11-06 06:56:07.849 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 06:56:07.851 MST [8857] LOG:  checkpoint complete: wrote 33 buffers (0.2%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.001 s, sync=0.001 s, total=0.003 s; sync files=20, longest=0.001 s, average=0.001 s; distance=4936 kB, estimate=5368 kB; lsn=0/5A47F58, redo lsn=0/5A47F20
2025-11-06 07:00:48.235 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 07:00:48.238 MST [8857] LOG:  checkpoint complete: wrote 13 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.002 s, sync=0.001 s, total=0.004 s; sync files=11, longest=0.001 s, average=0.001 s; distance=4947 kB, estimate=5326 kB; lsn=0/5F1CDE8, redo lsn=0/5F1CDB0
2025-11-06 07:00:48.365 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 07:00:48.367 MST [8857] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 1 recycled; write=0.001 s, sync=0.001 s, total=0.002 s; sync files=7, longest=0.001 s, average=0.001 s; distance=4912 kB, estimate=5285 kB; lsn=0/63E9160, redo lsn=0/63E9128
2025-11-06 07:05:48.369 MST [8857] LOG:  checkpoint starting: time
2025-11-06 07:05:49.189 MST [8857] LOG:  checkpoint complete: wrote 9 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.816 s, sync=0.002 s, total=0.821 s; sync files=9, longest=0.001 s, average=0.001 s; distance=23 kB, estimate=4758 kB; lsn=0/63EEFA8, redo lsn=0/63EEF70
2025-11-06 07:20:09.274 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 07:20:09.277 MST [8857] LOG:  checkpoint complete: wrote 8 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.002 s, sync=0.001 s, total=0.004 s; sync files=8, longest=0.001 s, average=0.001 s; distance=4906 kB, estimate=4906 kB; lsn=0/68B98E8, redo lsn=0/68B98B0
2025-11-06 07:20:09.389 MST [8724] ERROR:  setval: value 0 is out of bounds for sequence "AcademyModule_id_seq" (1..9223372036854775807)
2025-11-06 07:20:09.389 MST [8724] STATEMENT:  /*
	  Warnings:
	
	  - The primary key for the `AcademyModule` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `AcademyModule` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `AcademyProgress` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `AcademyProgress` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `Profile` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `Profile` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The `mentorId` column on the `Profile` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `Questionnaire` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `Questionnaire` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The `mentorId` column on the `RegistryNote` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `User` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `User` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - Changed the type of `userId` on the `AcademyProgress` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `moduleId` on the `AcademyProgress` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `authorId` on the `Announcement` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `authorId` on the `Comment` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `authorId` on the `CommunityPost` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `createdById` on the `Event` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `EventRsvp` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `senderId` on the `Message` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `receiverId` on the `Message` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `Profile` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `Questionnaire` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `RegistryItem` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `memberId` on the `WorkbookEntry` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	
	*/
	/* 
	  ✅ Safe Type Cast Migration
	  Converts text IDs to integer IDs across all related tables
	  while preserving data and restoring sequences and constraints.
	*/
	
	-- 1️⃣ Drop FKs temporarily
	ALTER TABLE "public"."AcademyProgress" DROP CONSTRAINT "AcademyProgress_moduleId_fkey";
	ALTER TABLE "public"."AcademyProgress" DROP CONSTRAINT "AcademyProgress_userId_fkey";
	ALTER TABLE "public"."Announcement" DROP CONSTRAINT "Announcement_authorId_fkey";
	ALTER TABLE "public"."Comment" DROP CONSTRAINT "Comment_authorId_fkey";
	ALTER TABLE "public"."CommunityPost" DROP CONSTRAINT "CommunityPost_authorId_fkey";
	ALTER TABLE "public"."Event" DROP CONSTRAINT "Event_createdById_fkey";
	ALTER TABLE "public"."EventRsvp" DROP CONSTRAINT "EventRsvp_eventId_fkey";
	ALTER TABLE "public"."EventRsvp" DROP CONSTRAINT "EventRsvp_userId_fkey";
	ALTER TABLE "public"."Profile" DROP CONSTRAINT "Profile_mentorId_fkey";
	ALTER TABLE "public"."Profile" DROP CONSTRAINT "Profile_userId_fkey";
	ALTER TABLE "public"."Questionnaire" DROP CONSTRAINT "Questionnaire_userId_fkey";
	ALTER TABLE "public"."RegistryItem" DROP CONSTRAINT "RegistryItem_userId_fkey";
	ALTER TABLE "public"."RegistryNote" DROP CONSTRAINT "RegistryNote_mentorId_fkey";
	ALTER TABLE "public"."WorkbookEntry" DROP CONSTRAINT "WorkbookEntry_memberId_fkey";
	ALTER TABLE "public"."WorkbookEntry" DROP CONSTRAINT "WorkbookEntry_moduleSlug_fkey";
	
	-- 2️⃣ Type Casts + Adjustments
	
	-- AcademyModule
	ALTER TABLE "AcademyModule"
	  ADD COLUMN IF NOT EXISTS "subtitle" TEXT,
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "content" SET DATA TYPE TEXT,
	  ALTER COLUMN "summary" DROP NOT NULL,
	  ALTER COLUMN "category" DROP NOT NULL,
	  ALTER COLUMN "lecture" DROP NOT NULL,
	  ALTER COLUMN "order" DROP NOT NULL,
	  ALTER COLUMN "workbookPrompt" DROP NOT NULL;
	CREATE SEQUENCE IF NOT EXISTS "AcademyModule_id_seq";
	SELECT setval('"AcademyModule_id_seq"', COALESCE((SELECT MAX("id") FROM "AcademyModule"), 0));
	ALTER TABLE "AcademyModule" ALTER COLUMN "id" SET DEFAULT nextval('"AcademyModule_id_seq"');
	ALTER SEQUENCE "AcademyModule_id_seq" OWNED BY "AcademyModule"."id";
	
	-- AcademyProgress
	ALTER TABLE "AcademyProgress"
	  ADD COLUMN IF NOT EXISTS "completed" BOOLEAN NOT NULL DEFAULT false,
	  ADD COLUMN IF NOT EXISTS "quizScore" INTEGER,
	  ADD COLUMN IF NOT EXISTS "reflection" TEXT,
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer,
	  ALTER COLUMN "moduleId" TYPE INTEGER USING "moduleId"::integer;
	CREATE SEQUENCE IF NOT EXISTS "AcademyProgress_id_seq";
	SELECT setval('"AcademyProgress_id_seq"', COALESCE((SELECT MAX("id") FROM "AcademyProgress"), 0));
	ALTER TABLE "AcademyProgress" ALTER COLUMN "id" SET DEFAULT nextval('"AcademyProgress_id_seq"');
	ALTER SEQUENCE "AcademyProgress_id_seq" OWNED BY "AcademyProgress"."id";
	
	-- Other tables (simple casts)
	ALTER TABLE "Announcement" ALTER COLUMN "authorId" TYPE INTEGER USING "authorId"::integer;
	ALTER TABLE "Comment" ALTER COLUMN "authorId" TYPE INTEGER USING "authorId"::integer;
	ALTER TABLE "CommunityPost" ALTER COLUMN "authorId" TYPE INTEGER USING "authorId"::integer;
	ALTER TABLE "Event" ALTER COLUMN "createdById" TYPE INTEGER USING "createdById"::integer;
	ALTER TABLE "EventRsvp" ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer;
	ALTER TABLE "Message" ALTER COLUMN "senderId" TYPE INTEGER USING "senderId"::integer, ALTER COLUMN "receiverId" TYPE INTEGER USING "receiverId"::integer;
	ALTER TABLE "RegistryItem" ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer;
	ALTER TABLE "RegistryNote" ALTER COLUMN "mentorId" TYPE INTEGER USING "mentorId"::integer;
	ALTER TABLE "WorkbookEntry" ALTER COLUMN "memberId" TYPE INTEGER USING "memberId"::integer;
	
	-- Profile
	ALTER TABLE "Profile"
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer,
	  ALTER COLUMN "mentorId" TYPE INTEGER USING "mentorId"::integer;
	CREATE SEQUENCE IF NOT EXISTS "Profile_id_seq";
	SELECT setval('"Profile_id_seq"', COALESCE((SELECT MAX("id") FROM "Profile"), 0));
	ALTER TABLE "Profile" ALTER COLUMN "id" SET DEFAULT nextval('"Profile_id_seq"');
	ALTER SEQUENCE "Profile_id_seq" OWNED BY "Profile"."id";
	
	-- Questionnaire
	ALTER TABLE "Questionnaire"
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer;
	CREATE SEQUENCE IF NOT EXISTS "Questionnaire_id_seq";
	SELECT setval('"Questionnaire_id_seq"', COALESCE((SELECT MAX("id") FROM "Questionnaire"), 0));
	ALTER TABLE "Questionnaire" ALTER COLUMN "id" SET DEFAULT nextval('"Questionnaire_id_seq"');
	ALTER SEQUENCE "Questionnaire_id_seq" OWNED BY "Questionnaire"."id";
	
	-- User
	ALTER TABLE "User"
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer;
	CREATE SEQUENCE IF NOT EXISTS "User_id_seq";
	SELECT setval('"User_id_seq"', COALESCE((SELECT MAX("id") FROM "User"), 0));
	ALTER TABLE "User" ALTER COLUMN "id" SET DEFAULT nextval('"User_id_seq"');
	ALTER SEQUENCE "User_id_seq" OWNED BY "User"."id";
	
	-- 3️⃣ Quiz Table
	CREATE TABLE IF NOT EXISTS "Quiz" (
	  "id" SERIAL PRIMARY KEY,
	  "moduleId" INTEGER NOT NULL,
	  "userId" INTEGER,
	  "question" TEXT NOT NULL,
	  "options" TEXT[],
	  "answer" TEXT NOT NULL,
	  "createdAt" TIMESTAMP(3) DEFAULT CURRENT_TIMESTAMP,
	  "updatedAt" TIMESTAMP(3) NOT NULL
	);
	CREATE INDEX IF NOT EXISTS "Quiz_moduleId_idx" ON "Quiz"("moduleId");
	CREATE INDEX IF NOT EXISTS "Quiz_userId_idx" ON "Quiz"("userId");
	CREATE UNIQUE INDEX IF NOT EXISTS "Quiz_moduleId_question_key" ON "Quiz"("moduleId", "question");
	
	-- 4️⃣ Re-add Foreign Keys
	ALTER TABLE "Profile" ADD CONSTRAINT "Profile_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Profile" ADD CONSTRAINT "Profile_mentorId_fkey" FOREIGN KEY ("mentorId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE;
	ALTER TABLE "Questionnaire" ADD CONSTRAINT "Questionnaire_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "AcademyProgress" ADD CONSTRAINT "AcademyProgress_moduleId_fkey" FOREIGN KEY ("moduleId") REFERENCES "AcademyModule"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "AcademyProgress" ADD CONSTRAINT "AcademyProgress_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Quiz" ADD CONSTRAINT "Quiz_moduleId_fkey" FOREIGN KEY ("moduleId") REFERENCES "AcademyModule"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Quiz" ADD CONSTRAINT "Quiz_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "RegistryItem" ADD CONSTRAINT "RegistryItem_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "RegistryNote" ADD CONSTRAINT "RegistryNote_mentorId_fkey" FOREIGN KEY ("mentorId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE;
	ALTER TABLE "CommunityPost" ADD CONSTRAINT "CommunityPost_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Comment" ADD CONSTRAINT "Comment_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Event" ADD CONSTRAINT "Event_createdById_fkey" FOREIGN KEY ("createdById") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "EventRsvp" ADD CONSTRAINT "EventRsvp_eventId_fkey" FOREIGN KEY ("eventId") REFERENCES "Event"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "EventRsvp" ADD CONSTRAINT "EventRsvp_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "WorkbookEntry" ADD CONSTRAINT "WorkbookEntry_memberId_fkey" FOREIGN KEY ("memberId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "WorkbookEntry" ADD CONSTRAINT "WorkbookEntry_moduleSlug_fkey" FOREIGN KEY ("moduleSlug") REFERENCES "AcademyModule"("slug") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Announcement" ADD CONSTRAINT "Announcement_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Message" ADD CONSTRAINT "Message_senderId_fkey" FOREIGN KEY ("senderId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Message" ADD CONSTRAINT "Message_receiverId_fkey" FOREIGN KEY ("receiverId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
2025-11-06 07:20:09.390 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 07:20:09.391 MST [8857] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.001 s, sync=0.001 s, total=0.002 s; sync files=7, longest=0.001 s, average=0.001 s; distance=4948 kB, estimate=4948 kB; lsn=0/6D8EBC8, redo lsn=0/6D8EB90
2025-11-06 07:25:09.367 MST [8857] LOG:  checkpoint starting: time
2025-11-06 07:25:09.988 MST [8857] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.617 s, sync=0.001 s, total=0.622 s; sync files=5, longest=0.001 s, average=0.001 s; distance=18 kB, estimate=4455 kB; lsn=0/6D93418, redo lsn=0/6D933E0
2025-11-06 07:26:30.134 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 07:26:30.136 MST [8857] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 1 recycled; write=0.002 s, sync=0.001 s, total=0.003 s; sync files=7, longest=0.001 s, average=0.001 s; distance=4912 kB, estimate=4912 kB; lsn=0/725F500, redo lsn=0/725F4C8
2025-11-06 07:26:30.249 MST [10780] ERROR:  function setval(unknown, integer, integer) does not exist at character 6055
2025-11-06 07:26:30.249 MST [10780] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2025-11-06 07:26:30.249 MST [10780] STATEMENT:  /*
	  Warnings:
	
	  - The primary key for the `AcademyModule` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `AcademyModule` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `AcademyProgress` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `AcademyProgress` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `Profile` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `Profile` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The `mentorId` column on the `Profile` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `Questionnaire` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `Questionnaire` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The `mentorId` column on the `RegistryNote` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `User` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `User` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - Changed the type of `userId` on the `AcademyProgress` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `moduleId` on the `AcademyProgress` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `authorId` on the `Announcement` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `authorId` on the `Comment` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `authorId` on the `CommunityPost` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `createdById` on the `Event` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `EventRsvp` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `senderId` on the `Message` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `receiverId` on the `Message` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `Profile` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `Questionnaire` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `RegistryItem` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `memberId` on the `WorkbookEntry` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	
	*/
	/* 
	  ✅ Safe Type Cast Migration
	  Converts text IDs to integer IDs across all related tables
	  while preserving data and restoring sequences and constraints.
	*/
	
	-- 1️⃣ Drop FKs temporarily
	ALTER TABLE "public"."AcademyProgress" DROP CONSTRAINT "AcademyProgress_moduleId_fkey";
	ALTER TABLE "public"."AcademyProgress" DROP CONSTRAINT "AcademyProgress_userId_fkey";
	ALTER TABLE "public"."Announcement" DROP CONSTRAINT "Announcement_authorId_fkey";
	ALTER TABLE "public"."Comment" DROP CONSTRAINT "Comment_authorId_fkey";
	ALTER TABLE "public"."CommunityPost" DROP CONSTRAINT "CommunityPost_authorId_fkey";
	ALTER TABLE "public"."Event" DROP CONSTRAINT "Event_createdById_fkey";
	ALTER TABLE "public"."EventRsvp" DROP CONSTRAINT "EventRsvp_eventId_fkey";
	ALTER TABLE "public"."EventRsvp" DROP CONSTRAINT "EventRsvp_userId_fkey";
	ALTER TABLE "public"."Profile" DROP CONSTRAINT "Profile_mentorId_fkey";
	ALTER TABLE "public"."Profile" DROP CONSTRAINT "Profile_userId_fkey";
	ALTER TABLE "public"."Questionnaire" DROP CONSTRAINT "Questionnaire_userId_fkey";
	ALTER TABLE "public"."RegistryItem" DROP CONSTRAINT "RegistryItem_userId_fkey";
	ALTER TABLE "public"."RegistryNote" DROP CONSTRAINT "RegistryNote_mentorId_fkey";
	ALTER TABLE "public"."WorkbookEntry" DROP CONSTRAINT "WorkbookEntry_memberId_fkey";
	ALTER TABLE "public"."WorkbookEntry" DROP CONSTRAINT "WorkbookEntry_moduleSlug_fkey";
	
	-- 2️⃣ Type Casts + Adjustments
	
	-- AcademyModule
	ALTER TABLE "AcademyModule"
	  ADD COLUMN IF NOT EXISTS "subtitle" TEXT,
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "content" SET DATA TYPE TEXT,
	  ALTER COLUMN "summary" DROP NOT NULL,
	  ALTER COLUMN "category" DROP NOT NULL,
	  ALTER COLUMN "lecture" DROP NOT NULL,
	  ALTER COLUMN "order" DROP NOT NULL,
	  ALTER COLUMN "workbookPrompt" DROP NOT NULL;
	CREATE SEQUENCE IF NOT EXISTS "AcademyModule_id_seq";
	SELECT setval('"AcademyModule_id_seq"', COALESCE((SELECT MAX("id") FROM "AcademyModule"), 1), 1);
	ALTER TABLE "AcademyModule" ALTER COLUMN "id" SET DEFAULT nextval('"AcademyModule_id_seq"');
	ALTER SEQUENCE "AcademyModule_id_seq" OWNED BY "AcademyModule"."id";
	
	-- AcademyProgress
	ALTER TABLE "AcademyProgress"
	  ADD COLUMN IF NOT EXISTS "completed" BOOLEAN NOT NULL DEFAULT false,
	  ADD COLUMN IF NOT EXISTS "quizScore" INTEGER,
	  ADD COLUMN IF NOT EXISTS "reflection" TEXT,
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer,
	  ALTER COLUMN "moduleId" TYPE INTEGER USING "moduleId"::integer;
	CREATE SEQUENCE IF NOT EXISTS "AcademyProgress_id_seq";
	SELECT setval('"AcademyProgress_id_seq"', COALESCE((SELECT MAX("id") FROM "AcademyProgress"), 1), 1);
	
	ALTER TABLE "AcademyProgress" ALTER COLUMN "id" SET DEFAULT nextval('"AcademyProgress_id_seq"');
	ALTER SEQUENCE "AcademyProgress_id_seq" OWNED BY "AcademyProgress"."id";
	
	-- Other tables (simple casts)
	ALTER TABLE "Announcement" ALTER COLUMN "authorId" TYPE INTEGER USING "authorId"::integer;
	ALTER TABLE "Comment" ALTER COLUMN "authorId" TYPE INTEGER USING "authorId"::integer;
	ALTER TABLE "CommunityPost" ALTER COLUMN "authorId" TYPE INTEGER USING "authorId"::integer;
	ALTER TABLE "Event" ALTER COLUMN "createdById" TYPE INTEGER USING "createdById"::integer;
	ALTER TABLE "EventRsvp" ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer;
	ALTER TABLE "Message" ALTER COLUMN "senderId" TYPE INTEGER USING "senderId"::integer, ALTER COLUMN "receiverId" TYPE INTEGER USING "receiverId"::integer;
	ALTER TABLE "RegistryItem" ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer;
	ALTER TABLE "RegistryNote" ALTER COLUMN "mentorId" TYPE INTEGER USING "mentorId"::integer;
	ALTER TABLE "WorkbookEntry" ALTER COLUMN "memberId" TYPE INTEGER USING "memberId"::integer;
	
	-- Profile
	ALTER TABLE "Profile"
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer,
	  ALTER COLUMN "mentorId" TYPE INTEGER USING "mentorId"::integer;
	CREATE SEQUENCE IF NOT EXISTS "Profile_id_seq";
	SELECT setval('"Profile_id_seq"', COALESCE((SELECT MAX("id") FROM "Profile"), 1), 1);
	ALTER TABLE "Profile" ALTER COLUMN "id" SET DEFAULT nextval('"Profile_id_seq"');
	ALTER SEQUENCE "Profile_id_seq" OWNED BY "Profile"."id";
	
	-- Questionnaire
	ALTER TABLE "Questionnaire"
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer;
	CREATE SEQUENCE IF NOT EXISTS "Questionnaire_id_seq";
	SELECT setval('"Questionnaire_id_seq"', COALESCE((SELECT MAX("id") FROM "Questionnaire"), 1), 1);
	ALTER TABLE "Questionnaire" ALTER COLUMN "id" SET DEFAULT nextval('"Questionnaire_id_seq"');
	ALTER SEQUENCE "Questionnaire_id_seq" OWNED BY "Questionnaire"."id";
	
	-- User
	ALTER TABLE "User"
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer;
	CREATE SEQUENCE IF NOT EXISTS "User_id_seq";
	SELECT setval('"User_id_seq"', COALESCE((SELECT MAX("id") FROM "User"), 1), 1);
	ALTER TABLE "User" ALTER COLUMN "id" SET DEFAULT nextval('"User_id_seq"');
	ALTER SEQUENCE "User_id_seq" OWNED BY "User"."id";
	
	-- 3️⃣ Quiz Table
	CREATE TABLE IF NOT EXISTS "Quiz" (
	  "id" SERIAL PRIMARY KEY,
	  "moduleId" INTEGER NOT NULL,
	  "userId" INTEGER,
	  "question" TEXT NOT NULL,
	  "options" TEXT[],
	  "answer" TEXT NOT NULL,
	  "createdAt" TIMESTAMP(3) DEFAULT CURRENT_TIMESTAMP,
	  "updatedAt" TIMESTAMP(3) NOT NULL
	);
	CREATE INDEX IF NOT EXISTS "Quiz_moduleId_idx" ON "Quiz"("moduleId");
	CREATE INDEX IF NOT EXISTS "Quiz_userId_idx" ON "Quiz"("userId");
	CREATE UNIQUE INDEX IF NOT EXISTS "Quiz_moduleId_question_key" ON "Quiz"("moduleId", "question");
	
	-- 4️⃣ Re-add Foreign Keys
	ALTER TABLE "Profile" ADD CONSTRAINT "Profile_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Profile" ADD CONSTRAINT "Profile_mentorId_fkey" FOREIGN KEY ("mentorId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE;
	ALTER TABLE "Questionnaire" ADD CONSTRAINT "Questionnaire_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "AcademyProgress" ADD CONSTRAINT "AcademyProgress_moduleId_fkey" FOREIGN KEY ("moduleId") REFERENCES "AcademyModule"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "AcademyProgress" ADD CONSTRAINT "AcademyProgress_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Quiz" ADD CONSTRAINT "Quiz_moduleId_fkey" FOREIGN KEY ("moduleId") REFERENCES "AcademyModule"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Quiz" ADD CONSTRAINT "Quiz_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "RegistryItem" ADD CONSTRAINT "RegistryItem_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "RegistryNote" ADD CONSTRAINT "RegistryNote_mentorId_fkey" FOREIGN KEY ("mentorId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE;
	ALTER TABLE "CommunityPost" ADD CONSTRAINT "CommunityPost_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Comment" ADD CONSTRAINT "Comment_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Event" ADD CONSTRAINT "Event_createdById_fkey" FOREIGN KEY ("createdById") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "EventRsvp" ADD CONSTRAINT "EventRsvp_eventId_fkey" FOREIGN KEY ("eventId") REFERENCES "Event"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "EventRsvp" ADD CONSTRAINT "EventRsvp_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "WorkbookEntry" ADD CONSTRAINT "WorkbookEntry_memberId_fkey" FOREIGN KEY ("memberId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "WorkbookEntry" ADD CONSTRAINT "WorkbookEntry_moduleSlug_fkey" FOREIGN KEY ("moduleSlug") REFERENCES "AcademyModule"("slug") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Announcement" ADD CONSTRAINT "Announcement_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Message" ADD CONSTRAINT "Message_senderId_fkey" FOREIGN KEY ("senderId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Message" ADD CONSTRAINT "Message_receiverId_fkey" FOREIGN KEY ("receiverId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
2025-11-06 07:26:30.250 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 07:26:30.251 MST [8857] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.001 s, sync=0.001 s, total=0.002 s; sync files=7, longest=0.001 s, average=0.001 s; distance=4954 kB, estimate=4954 kB; lsn=0/77360A8, redo lsn=0/7736070
2025-11-06 07:31:30.251 MST [8857] LOG:  checkpoint starting: time
2025-11-06 07:31:30.979 MST [8857] LOG:  checkpoint complete: wrote 8 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.719 s, sync=0.002 s, total=0.728 s; sync files=8, longest=0.001 s, average=0.001 s; distance=27 kB, estimate=4462 kB; lsn=0/773D068, redo lsn=0/773D030
2025-11-06 07:34:48.864 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 07:34:48.866 MST [8857] LOG:  checkpoint complete: wrote 8 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.002 s, sync=0.001 s, total=0.003 s; sync files=8, longest=0.001 s, average=0.001 s; distance=4907 kB, estimate=4907 kB; lsn=0/7C07DA8, redo lsn=0/7C07D70
2025-11-06 07:34:48.976 MST [13604] ERROR:  syntax error at or near "regclass" at character 8350
2025-11-06 07:34:48.976 MST [13604] STATEMENT:  /*
	  Warnings:
	
	  - The primary key for the `AcademyModule` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `AcademyModule` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `AcademyProgress` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `AcademyProgress` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `Profile` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `Profile` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The `mentorId` column on the `Profile` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `Questionnaire` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `Questionnaire` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The `mentorId` column on the `RegistryNote` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - The primary key for the `User` table will be changed. If it partially fails, the table could be left without primary key constraint.
	  - The `id` column on the `User` table would be dropped and recreated. This will lead to data loss if there is data in the column.
	  - Changed the type of `userId` on the `AcademyProgress` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `moduleId` on the `AcademyProgress` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `authorId` on the `Announcement` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `authorId` on the `Comment` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `authorId` on the `CommunityPost` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `createdById` on the `Event` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `EventRsvp` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `senderId` on the `Message` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `receiverId` on the `Message` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `Profile` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `Questionnaire` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `userId` on the `RegistryItem` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	  - Changed the type of `memberId` on the `WorkbookEntry` table. No cast exists, the column would be dropped and recreated, which cannot be done if there is data, since the column is required.
	
	*/
	/* 
	  ✅ Safe Type Cast Migration
	  Converts text IDs to integer IDs across all related tables
	  while preserving data and restoring sequences and constraints.
	*/
	
	-- 1️⃣ Drop FKs temporarily
	ALTER TABLE "public"."AcademyProgress" DROP CONSTRAINT "AcademyProgress_moduleId_fkey";
	ALTER TABLE "public"."AcademyProgress" DROP CONSTRAINT "AcademyProgress_userId_fkey";
	ALTER TABLE "public"."Announcement" DROP CONSTRAINT "Announcement_authorId_fkey";
	ALTER TABLE "public"."Comment" DROP CONSTRAINT "Comment_authorId_fkey";
	ALTER TABLE "public"."CommunityPost" DROP CONSTRAINT "CommunityPost_authorId_fkey";
	ALTER TABLE "public"."Event" DROP CONSTRAINT "Event_createdById_fkey";
	ALTER TABLE "public"."EventRsvp" DROP CONSTRAINT "EventRsvp_eventId_fkey";
	ALTER TABLE "public"."EventRsvp" DROP CONSTRAINT "EventRsvp_userId_fkey";
	ALTER TABLE "public"."Profile" DROP CONSTRAINT "Profile_mentorId_fkey";
	ALTER TABLE "public"."Profile" DROP CONSTRAINT "Profile_userId_fkey";
	ALTER TABLE "public"."Questionnaire" DROP CONSTRAINT "Questionnaire_userId_fkey";
	ALTER TABLE "public"."RegistryItem" DROP CONSTRAINT "RegistryItem_userId_fkey";
	ALTER TABLE "public"."RegistryNote" DROP CONSTRAINT "RegistryNote_mentorId_fkey";
	ALTER TABLE "public"."WorkbookEntry" DROP CONSTRAINT "WorkbookEntry_memberId_fkey";
	ALTER TABLE "public"."WorkbookEntry" DROP CONSTRAINT "WorkbookEntry_moduleSlug_fkey";
	
	-- 2️⃣ Type Casts + Adjustments
	
	-- AcademyModule
	ALTER TABLE "AcademyModule"
	  ADD COLUMN IF NOT EXISTS "subtitle" TEXT,
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "content" SET DATA TYPE TEXT,
	  ALTER COLUMN "summary" DROP NOT NULL,
	  ALTER COLUMN "category" DROP NOT NULL,
	  ALTER COLUMN "lecture" DROP NOT NULL,
	  ALTER COLUMN "order" DROP NOT NULL,
	  ALTER COLUMN "workbookPrompt" DROP NOT NULL;
	CREATE SEQUENCE IF NOT EXISTS "AcademyModule_id_seq";
	SELECT setval('"AcademyModule_id_seq"'::regclass, GREATEST(COALESCE((SELECT MAX("id") FROM "AcademyModule"), 1), 1)::bigint, true);
	ALTER TABLE "AcademyModule" ALTER COLUMN "id" SET DEFAULT nextval('"AcademyModule_id_seq"');
	ALTER SEQUENCE "AcademyModule_id_seq" OWNED BY "AcademyModule"."id";
	
	-- AcademyProgress
	ALTER TABLE "AcademyProgress"
	  ADD COLUMN IF NOT EXISTS "completed" BOOLEAN NOT NULL DEFAULT false,
	  ADD COLUMN IF NOT EXISTS "quizScore" INTEGER,
	  ADD COLUMN IF NOT EXISTS "reflection" TEXT,
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer,
	  ALTER COLUMN "moduleId" TYPE INTEGER USING "moduleId"::integer;
	CREATE SEQUENCE IF NOT EXISTS "AcademyProgress_id_seq";
	SELECT setval('"AcademyProgress_id_seq"'::regclass, GREATEST(COALESCE((SELECT MAX("id") FROM "AcademyProgress"), 1), 1)::bigint, true);
	ALTER TABLE "AcademyProgress" ALTER COLUMN "id" SET DEFAULT nextval('"AcademyProgress_id_seq"');
	ALTER SEQUENCE "AcademyProgress_id_seq" OWNED BY "AcademyProgress"."id";
	
	-- Other tables (simple casts)
	ALTER TABLE "Announcement" ALTER COLUMN "authorId" TYPE INTEGER USING "authorId"::integer;
	ALTER TABLE "Comment" ALTER COLUMN "authorId" TYPE INTEGER USING "authorId"::integer;
	ALTER TABLE "CommunityPost" ALTER COLUMN "authorId" TYPE INTEGER USING "authorId"::integer;
	ALTER TABLE "Event" ALTER COLUMN "createdById" TYPE INTEGER USING "createdById"::integer;
	ALTER TABLE "EventRsvp" ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer;
	ALTER TABLE "Message" ALTER COLUMN "senderId" TYPE INTEGER USING "senderId"::integer, ALTER COLUMN "receiverId" TYPE INTEGER USING "receiverId"::integer;
	ALTER TABLE "RegistryItem" ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer;
	ALTER TABLE "RegistryNote" ALTER COLUMN "mentorId" TYPE INTEGER USING "mentorId"::integer;
	ALTER TABLE "WorkbookEntry" ALTER COLUMN "memberId" TYPE INTEGER USING "memberId"::integer;
	
	-- Profile
	ALTER TABLE "Profile"
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer,
	  ALTER COLUMN "mentorId" TYPE INTEGER USING "mentorId"::integer;
	CREATE SEQUENCE IF NOT EXISTS "Profile_id_seq";
	SELECT setval('"Profile_id_seq"', COALESCE((SELECT MAX("id") FROM "Profile"), 1), 1); regclass, GREATEST(COALESCE((SELECT MAX("id") FROM "Profile"), 1), 1)::bigint, true);
	ALTER TABLE "Profile" ALTER COLUMN "id" SET DEFAULT nextval('"Profile_id_seq"');
	ALTER SEQUENCE "Profile_id_seq" OWNED BY "Profile"."id";
	
	-- Questionnaire
	ALTER TABLE "Questionnaire"
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer;
	CREATE SEQUENCE IF NOT EXISTS "Questionnaire_id_seq";
	SELECT setval('"Questionnaire_id_seq"', COALESCE((SELECT MAX("id") FROM "Questionnaire"), 1), 1); regclass, GREATEST(COALESCE((SELECT MAX("id") FROM "Questionnaire"), 1), 1)::bigint, true);
	ALTER TABLE "Questionnaire" ALTER COLUMN "id" SET DEFAULT nextval('"Questionnaire_id_seq"');
	ALTER SEQUENCE "Questionnaire_id_seq" OWNED BY "Questionnaire"."id";
	
	-- User
	ALTER TABLE "User"
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer;
	CREATE SEQUENCE IF NOT EXISTS "User_id_seq";
	SELECT setval('"User_id_seq"', COALESCE((SELECT MAX("id") FROM "User"), 1), 1); regclass, GREATEST(COALESCE((SELECT MAX("id") FROM "User"), 1), 1)::bigint, true);
	ALTER TABLE "User" ALTER COLUMN "id" SET DEFAULT nextval('"User_id_seq"');
	ALTER SEQUENCE "User_id_seq" OWNED BY "User"."id";
	
	-- 3️⃣ Quiz Table
	CREATE TABLE IF NOT EXISTS "Quiz" (
	  "id" SERIAL PRIMARY KEY,
	  "moduleId" INTEGER NOT NULL,
	  "userId" INTEGER,
	  "question" TEXT NOT NULL,
	  "options" TEXT[],
	  "answer" TEXT NOT NULL,
	  "createdAt" TIMESTAMP(3) DEFAULT CURRENT_TIMESTAMP,
	  "updatedAt" TIMESTAMP(3) NOT NULL
	);
	CREATE INDEX IF NOT EXISTS "Quiz_moduleId_idx" ON "Quiz"("moduleId");
	CREATE INDEX IF NOT EXISTS "Quiz_userId_idx" ON "Quiz"("userId");
	CREATE UNIQUE INDEX IF NOT EXISTS "Quiz_moduleId_question_key" ON "Quiz"("moduleId", "question");
	
	-- 4️⃣ Re-add Foreign Keys
	ALTER TABLE "Profile" ADD CONSTRAINT "Profile_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Profile" ADD CONSTRAINT "Profile_mentorId_fkey" FOREIGN KEY ("mentorId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE;
	ALTER TABLE "Questionnaire" ADD CONSTRAINT "Questionnaire_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "AcademyProgress" ADD CONSTRAINT "AcademyProgress_moduleId_fkey" FOREIGN KEY ("moduleId") REFERENCES "AcademyModule"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "AcademyProgress" ADD CONSTRAINT "AcademyProgress_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Quiz" ADD CONSTRAINT "Quiz_moduleId_fkey" FOREIGN KEY ("moduleId") REFERENCES "AcademyModule"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Quiz" ADD CONSTRAINT "Quiz_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "RegistryItem" ADD CONSTRAINT "RegistryItem_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "RegistryNote" ADD CONSTRAINT "RegistryNote_mentorId_fkey" FOREIGN KEY ("mentorId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE;
	ALTER TABLE "CommunityPost" ADD CONSTRAINT "CommunityPost_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Comment" ADD CONSTRAINT "Comment_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Event" ADD CONSTRAINT "Event_createdById_fkey" FOREIGN KEY ("createdById") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "EventRsvp" ADD CONSTRAINT "EventRsvp_eventId_fkey" FOREIGN KEY ("eventId") REFERENCES "Event"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "EventRsvp" ADD CONSTRAINT "EventRsvp_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "WorkbookEntry" ADD CONSTRAINT "WorkbookEntry_memberId_fkey" FOREIGN KEY ("memberId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "WorkbookEntry" ADD CONSTRAINT "WorkbookEntry_moduleSlug_fkey" FOREIGN KEY ("moduleSlug") REFERENCES "AcademyModule"("slug") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Announcement" ADD CONSTRAINT "Announcement_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Message" ADD CONSTRAINT "Message_senderId_fkey" FOREIGN KEY ("senderId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Message" ADD CONSTRAINT "Message_receiverId_fkey" FOREIGN KEY ("receiverId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
2025-11-06 07:34:48.977 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 07:34:48.978 MST [8857] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 1 recycled; write=0.001 s, sync=0.001 s, total=0.002 s; sync files=7, longest=0.001 s, average=0.001 s; distance=4909 kB, estimate=4909 kB; lsn=0/80D3240, redo lsn=0/80D3208
2025-11-06 07:39:48.978 MST [8857] LOG:  checkpoint starting: time
2025-11-06 07:39:49.392 MST [8857] LOG:  checkpoint complete: wrote 5 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.407 s, sync=0.001 s, total=0.414 s; sync files=5, longest=0.001 s, average=0.001 s; distance=13 kB, estimate=4419 kB; lsn=0/80D6800, redo lsn=0/80D67C8
2025-11-06 07:40:00.370 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 07:40:00.372 MST [8857] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.001 s, sync=0.001 s, total=0.003 s; sync files=7, longest=0.001 s, average=0.001 s; distance=4914 kB, estimate=4914 kB; lsn=0/85A3128, redo lsn=0/85A30F0
2025-11-06 07:40:00.484 MST [15374] ERROR:  setval: value 0 is out of bounds for sequence "AcademyModule_id_seq" (1..9223372036854775807)
2025-11-06 07:40:00.484 MST [15374] STATEMENT:  /*
	  Safe type-cast migration: convert text IDs to integers without dropping data.
	*/
	
	-- Drop foreign keys prior to type changes
	ALTER TABLE "public"."AcademyProgress" DROP CONSTRAINT "AcademyProgress_moduleId_fkey";
	ALTER TABLE "public"."AcademyProgress" DROP CONSTRAINT "AcademyProgress_userId_fkey";
	ALTER TABLE "public"."Announcement" DROP CONSTRAINT "Announcement_authorId_fkey";
	ALTER TABLE "public"."Comment" DROP CONSTRAINT "Comment_authorId_fkey";
	ALTER TABLE "public"."CommunityPost" DROP CONSTRAINT "CommunityPost_authorId_fkey";
	ALTER TABLE "public"."Event" DROP CONSTRAINT "Event_createdById_fkey";
	ALTER TABLE "public"."EventRsvp" DROP CONSTRAINT "EventRsvp_eventId_fkey";
	ALTER TABLE "public"."EventRsvp" DROP CONSTRAINT "EventRsvp_userId_fkey";
	ALTER TABLE "public"."Profile" DROP CONSTRAINT "Profile_mentorId_fkey";
	ALTER TABLE "public"."Profile" DROP CONSTRAINT "Profile_userId_fkey";
	ALTER TABLE "public"."Questionnaire" DROP CONSTRAINT "Questionnaire_userId_fkey";
	ALTER TABLE "public"."RegistryItem" DROP CONSTRAINT "RegistryItem_userId_fkey";
	ALTER TABLE "public"."RegistryNote" DROP CONSTRAINT "RegistryNote_mentorId_fkey";
	ALTER TABLE "public"."WorkbookEntry" DROP CONSTRAINT "WorkbookEntry_memberId_fkey";
	ALTER TABLE "public"."WorkbookEntry" DROP CONSTRAINT "WorkbookEntry_moduleSlug_fkey";
	
	-- Convert primary/foreign-key columns using safe casts
	ALTER TABLE "AcademyModule"
	  ADD COLUMN IF NOT EXISTS "subtitle" TEXT,
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "content" SET DATA TYPE TEXT,
	  ALTER COLUMN "summary" DROP NOT NULL,
	  ALTER COLUMN "summary" DROP DEFAULT,
	  ALTER COLUMN "category" DROP NOT NULL,
	  ALTER COLUMN "category" DROP DEFAULT,
	  ALTER COLUMN "lecture" DROP NOT NULL,
	  ALTER COLUMN "lecture" DROP DEFAULT,
	  ALTER COLUMN "order" DROP NOT NULL,
	  ALTER COLUMN "order" DROP DEFAULT,
	  ALTER COLUMN "workbookPrompt" DROP NOT NULL,
	  ALTER COLUMN "workbookPrompt" DROP DEFAULT;
	
	CREATE SEQUENCE IF NOT EXISTS "AcademyModule_id_seq";
	SELECT setval('"AcademyModule_id_seq"'::regclass, GREATEST(COALESCE((SELECT MAX("id") FROM "AcademyModule"), 0), 0), true);
	ALTER TABLE "AcademyModule" ALTER COLUMN "id" SET DEFAULT nextval('"AcademyModule_id_seq"'::regclass);
	ALTER SEQUENCE "AcademyModule_id_seq" OWNED BY "AcademyModule"."id";
	
	ALTER TABLE "AcademyProgress"
	  ADD COLUMN IF NOT EXISTS "completed" BOOLEAN NOT NULL DEFAULT false,
	  ADD COLUMN IF NOT EXISTS "quizScore" INTEGER,
	  ADD COLUMN IF NOT EXISTS "reflection" TEXT,
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer,
	  ALTER COLUMN "moduleId" TYPE INTEGER USING "moduleId"::integer;
	
	CREATE SEQUENCE IF NOT EXISTS "AcademyProgress_id_seq";
	SELECT setval('"AcademyProgress_id_seq"'::regclass, GREATEST(COALESCE((SELECT MAX("id") FROM "AcademyProgress"), 0), 0), true);
	ALTER TABLE "AcademyProgress" ALTER COLUMN "id" SET DEFAULT nextval('"AcademyProgress_id_seq"'::regclass);
	ALTER SEQUENCE "AcademyProgress_id_seq" OWNED BY "AcademyProgress"."id";
	
	ALTER TABLE "Announcement"
	  ALTER COLUMN "authorId" TYPE INTEGER USING "authorId"::integer;
	
	ALTER TABLE "Comment"
	  ALTER COLUMN "authorId" TYPE INTEGER USING "authorId"::integer;
	
	ALTER TABLE "CommunityPost"
	  ALTER COLUMN "authorId" TYPE INTEGER USING "authorId"::integer;
	
	ALTER TABLE "Event"
	  ALTER COLUMN "createdById" TYPE INTEGER USING "createdById"::integer;
	
	ALTER TABLE "EventRsvp"
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer;
	
	ALTER TABLE "Message"
	  ALTER COLUMN "senderId" TYPE INTEGER USING "senderId"::integer,
	  ALTER COLUMN "receiverId" TYPE INTEGER USING "receiverId"::integer;
	
	ALTER TABLE "Profile"
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer,
	  ALTER COLUMN "mentorId" TYPE INTEGER USING "mentorId"::integer;
	
	CREATE SEQUENCE IF NOT EXISTS "Profile_id_seq";
	SELECT setval('"Profile_id_seq"'::regclass, GREATEST(COALESCE((SELECT MAX("id") FROM "Profile"), 0), 0), true);
	ALTER TABLE "Profile" ALTER COLUMN "id" SET DEFAULT nextval('"Profile_id_seq"'::regclass);
	ALTER SEQUENCE "Profile_id_seq" OWNED BY "Profile"."id";
	
	ALTER TABLE "Questionnaire"
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer;
	
	CREATE SEQUENCE IF NOT EXISTS "Questionnaire_id_seq";
	SELECT setval('"Questionnaire_id_seq"'::regclass, GREATEST(COALESCE((SELECT MAX("id") FROM "Questionnaire"), 0), 0), true);
	ALTER TABLE "Questionnaire" ALTER COLUMN "id" SET DEFAULT nextval('"Questionnaire_id_seq"'::regclass);
	ALTER SEQUENCE "Questionnaire_id_seq" OWNED BY "Questionnaire"."id";
	
	ALTER TABLE "RegistryItem"
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer;
	
	ALTER TABLE "RegistryNote"
	  ALTER COLUMN "mentorId" TYPE INTEGER USING "mentorId"::integer;
	
	ALTER TABLE "User"
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer;
	
	CREATE SEQUENCE IF NOT EXISTS "User_id_seq";
	SELECT setval('"User_id_seq"'::regclass, GREATEST(COALESCE((SELECT MAX("id") FROM "User"), 0), 0), true);
	ALTER TABLE "User" ALTER COLUMN "id" SET DEFAULT nextval('"User_id_seq"'::regclass);
	ALTER SEQUENCE "User_id_seq" OWNED BY "User"."id";
	
	ALTER TABLE "WorkbookEntry"
	  ALTER COLUMN "memberId" TYPE INTEGER USING "memberId"::integer;
	
	-- Create Quiz table and indexes if not present
	CREATE TABLE IF NOT EXISTS "Quiz" (
	    "id" SERIAL NOT NULL,
	    "moduleId" INTEGER NOT NULL,
	    "userId" INTEGER,
	    "question" TEXT NOT NULL,
	    "options" TEXT[],
	    "answer" TEXT NOT NULL,
	    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
	    "updatedAt" TIMESTAMP(3) NOT NULL,
	    CONSTRAINT "Quiz_pkey" PRIMARY KEY ("id")
	);
	
	CREATE INDEX IF NOT EXISTS "Quiz_moduleId_idx" ON "Quiz"("moduleId");
	CREATE INDEX IF NOT EXISTS "Quiz_userId_idx" ON "Quiz"("userId");
	CREATE UNIQUE INDEX IF NOT EXISTS "Quiz_moduleId_question_key" ON "Quiz"("moduleId", "question");
	CREATE UNIQUE INDEX IF NOT EXISTS "AcademyProgress_userId_moduleId_key" ON "AcademyProgress"("userId", "moduleId");
	CREATE UNIQUE INDEX IF NOT EXISTS "EventRsvp_eventId_userId_key" ON "EventRsvp"("eventId", "userId");
	CREATE INDEX IF NOT EXISTS "Message_senderId_idx" ON "Message"("senderId");
	CREATE INDEX IF NOT EXISTS "Message_receiverId_idx" ON "Message"("receiverId");
	CREATE UNIQUE INDEX IF NOT EXISTS "Profile_userId_key" ON "Profile"("userId");
	CREATE INDEX IF NOT EXISTS "Profile_mentorId_idx" ON "Profile"("mentorId");
	CREATE UNIQUE INDEX IF NOT EXISTS "Questionnaire_userId_key" ON "Questionnaire"("userId");
	CREATE UNIQUE INDEX IF NOT EXISTS "RegistryItem_externalId_userId_key" ON "RegistryItem"("externalId", "userId");
	CREATE UNIQUE INDEX IF NOT EXISTS "RegistryNote_registryItemId_mentorId_key" ON "RegistryNote"("registryItemId", "mentorId");
	CREATE UNIQUE INDEX IF NOT EXISTS "WorkbookEntry_memberId_moduleSlug_key" ON "WorkbookEntry"("memberId", "moduleSlug");
	
	-- Restore foreign keys
	ALTER TABLE "Profile" ADD CONSTRAINT "Profile_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Profile" ADD CONSTRAINT "Profile_mentorId_fkey" FOREIGN KEY ("mentorId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE;
	ALTER TABLE "Questionnaire" ADD CONSTRAINT "Questionnaire_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "AcademyProgress" ADD CONSTRAINT "AcademyProgress_moduleId_fkey" FOREIGN KEY ("moduleId") REFERENCES "AcademyModule"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "AcademyProgress" ADD CONSTRAINT "AcademyProgress_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Quiz" ADD CONSTRAINT "Quiz_moduleId_fkey" FOREIGN KEY ("moduleId") REFERENCES "AcademyModule"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Quiz" ADD CONSTRAINT "Quiz_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "RegistryItem" ADD CONSTRAINT "RegistryItem_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "RegistryNote" ADD CONSTRAINT "RegistryNote_mentorId_fkey" FOREIGN KEY ("mentorId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE;
	ALTER TABLE "CommunityPost" ADD CONSTRAINT "CommunityPost_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Comment" ADD CONSTRAINT "Comment_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Event" ADD CONSTRAINT "Event_createdById_fkey" FOREIGN KEY ("createdById") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "EventRsvp" ADD CONSTRAINT "EventRsvp_eventId_fkey" FOREIGN KEY ("eventId") REFERENCES "Event"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "EventRsvp" ADD CONSTRAINT "EventRsvp_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "WorkbookEntry" ADD CONSTRAINT "WorkbookEntry_memberId_fkey" FOREIGN KEY ("memberId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "WorkbookEntry" ADD CONSTRAINT "WorkbookEntry_moduleSlug_fkey" FOREIGN KEY ("moduleSlug") REFERENCES "AcademyModule"("slug") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Announcement" ADD CONSTRAINT "Announcement_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Message" ADD CONSTRAINT "Message_senderId_fkey" FOREIGN KEY ("senderId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Message" ADD CONSTRAINT "Message_receiverId_fkey" FOREIGN KEY ("receiverId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
2025-11-06 07:40:00.485 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 07:40:00.486 MST [8857] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.001 s, sync=0.001 s, total=0.002 s; sync files=7, longest=0.001 s, average=0.001 s; distance=4959 kB, estimate=4959 kB; lsn=0/8A7AEC8, redo lsn=0/8A7AE90
2025-11-06 07:41:24.907 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 07:41:24.910 MST [8857] LOG:  checkpoint complete: wrote 14 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.002 s, sync=0.001 s, total=0.004 s; sync files=12, longest=0.001 s, average=0.001 s; distance=4960 kB, estimate=4960 kB; lsn=0/8F53128, redo lsn=0/8F530F0
2025-11-06 07:41:25.026 MST [15968] ERROR:  foreign key constraint "Message_senderId_fkey" cannot be implemented
2025-11-06 07:41:25.026 MST [15968] DETAIL:  Key columns "senderId" and "id" are of incompatible types: integer and text.
2025-11-06 07:41:25.026 MST [15968] STATEMENT:  /*
	  Safe type-cast migration: convert text IDs to integers without dropping data.
	*/
	
	-- Drop foreign keys prior to type changes
	ALTER TABLE "public"."AcademyProgress" DROP CONSTRAINT "AcademyProgress_moduleId_fkey";
	ALTER TABLE "public"."AcademyProgress" DROP CONSTRAINT "AcademyProgress_userId_fkey";
	ALTER TABLE "public"."Announcement" DROP CONSTRAINT "Announcement_authorId_fkey";
	ALTER TABLE "public"."Comment" DROP CONSTRAINT "Comment_authorId_fkey";
	ALTER TABLE "public"."CommunityPost" DROP CONSTRAINT "CommunityPost_authorId_fkey";
	ALTER TABLE "public"."Event" DROP CONSTRAINT "Event_createdById_fkey";
	ALTER TABLE "public"."EventRsvp" DROP CONSTRAINT "EventRsvp_eventId_fkey";
	ALTER TABLE "public"."EventRsvp" DROP CONSTRAINT "EventRsvp_userId_fkey";
	ALTER TABLE "public"."Profile" DROP CONSTRAINT "Profile_mentorId_fkey";
	ALTER TABLE "public"."Profile" DROP CONSTRAINT "Profile_userId_fkey";
	ALTER TABLE "public"."Questionnaire" DROP CONSTRAINT "Questionnaire_userId_fkey";
	ALTER TABLE "public"."RegistryItem" DROP CONSTRAINT "RegistryItem_userId_fkey";
	ALTER TABLE "public"."RegistryNote" DROP CONSTRAINT "RegistryNote_mentorId_fkey";
	ALTER TABLE "public"."WorkbookEntry" DROP CONSTRAINT "WorkbookEntry_memberId_fkey";
	ALTER TABLE "public"."WorkbookEntry" DROP CONSTRAINT "WorkbookEntry_moduleSlug_fkey";
	
	-- Convert primary/foreign-key columns using safe casts
	ALTER TABLE "AcademyModule"
	  ADD COLUMN IF NOT EXISTS "subtitle" TEXT,
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "content" SET DATA TYPE TEXT,
	  ALTER COLUMN "summary" DROP NOT NULL,
	  ALTER COLUMN "summary" DROP DEFAULT,
	  ALTER COLUMN "category" DROP NOT NULL,
	  ALTER COLUMN "category" DROP DEFAULT,
	  ALTER COLUMN "lecture" DROP NOT NULL,
	  ALTER COLUMN "lecture" DROP DEFAULT,
	  ALTER COLUMN "order" DROP NOT NULL,
	  ALTER COLUMN "order" DROP DEFAULT,
	  ALTER COLUMN "workbookPrompt" DROP NOT NULL,
	  ALTER COLUMN "workbookPrompt" DROP DEFAULT;
	
	CREATE SEQUENCE IF NOT EXISTS "AcademyModule_id_seq";
	SELECT setval('"AcademyModule_id_seq"'::regclass, GREATEST(COALESCE((SELECT MAX("id") FROM "AcademyModule"), 0), 1), true);
	ALTER TABLE "AcademyModule" ALTER COLUMN "id" SET DEFAULT nextval('"AcademyModule_id_seq"'::regclass);
	ALTER SEQUENCE "AcademyModule_id_seq" OWNED BY "AcademyModule"."id";
	
	ALTER TABLE "AcademyProgress"
	  ADD COLUMN IF NOT EXISTS "completed" BOOLEAN NOT NULL DEFAULT false,
	  ADD COLUMN IF NOT EXISTS "quizScore" INTEGER,
	  ADD COLUMN IF NOT EXISTS "reflection" TEXT,
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer,
	  ALTER COLUMN "moduleId" TYPE INTEGER USING "moduleId"::integer;
	
	CREATE SEQUENCE IF NOT EXISTS "AcademyProgress_id_seq";
	SELECT setval('"AcademyProgress_id_seq"'::regclass, GREATEST(COALESCE((SELECT MAX("id") FROM "AcademyProgress"), 0), 1), true);
	ALTER TABLE "AcademyProgress" ALTER COLUMN "id" SET DEFAULT nextval('"AcademyProgress_id_seq"'::regclass);
	ALTER SEQUENCE "AcademyProgress_id_seq" OWNED BY "AcademyProgress"."id";
	
	ALTER TABLE "Announcement"
	  ALTER COLUMN "authorId" TYPE INTEGER USING "authorId"::integer;
	
	ALTER TABLE "Comment"
	  ALTER COLUMN "authorId" TYPE INTEGER USING "authorId"::integer;
	
	ALTER TABLE "CommunityPost"
	  ALTER COLUMN "authorId" TYPE INTEGER USING "authorId"::integer;
	
	ALTER TABLE "Event"
	  ALTER COLUMN "createdById" TYPE INTEGER USING "createdById"::integer;
	
	ALTER TABLE "EventRsvp"
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer;
	
	ALTER TABLE "Message"
	  ALTER COLUMN "senderId" TYPE INTEGER USING "senderId"::integer,
	  ALTER COLUMN "receiverId" TYPE INTEGER USING "receiverId"::integer;
	
	ALTER TABLE "Profile"
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer,
	  ALTER COLUMN "mentorId" TYPE INTEGER USING "mentorId"::integer;
	
	CREATE SEQUENCE IF NOT EXISTS "Profile_id_seq";
	SELECT setval('"Profile_id_seq"'::regclass, GREATEST(COALESCE((SELECT MAX("id") FROM "Profile"), 0), 1), true);
	ALTER TABLE "Profile" ALTER COLUMN "id" SET DEFAULT nextval('"Profile_id_seq"'::regclass);
	ALTER SEQUENCE "Profile_id_seq" OWNED BY "Profile"."id";
	
	ALTER TABLE "Questionnaire"
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer,
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer;
	
	CREATE SEQUENCE IF NOT EXISTS "Questionnaire_id_seq";
	SELECT setval('"Questionnaire_id_seq"'::regclass, GREATEST(COALESCE((SELECT MAX("id") FROM "Questionnaire"), 0), 1), true);
	ALTER TABLE "Questionnaire" ALTER COLUMN "id" SET DEFAULT nextval('"Questionnaire_id_seq"'::regclass);
	ALTER SEQUENCE "Questionnaire_id_seq" OWNED BY "Questionnaire"."id";
	
	ALTER TABLE "RegistryItem"
	  ALTER COLUMN "userId" TYPE INTEGER USING "userId"::integer;
	
	ALTER TABLE "RegistryNote"
	  ALTER COLUMN "mentorId" TYPE INTEGER USING "mentorId"::integer;
	
	ALTER TABLE "User"
	  ALTER COLUMN "id" TYPE INTEGER USING "id"::integer;
	
	CREATE SEQUENCE IF NOT EXISTS "User_id_seq";
	SELECT setval('"User_id_seq"'::regclass, GREATEST(COALESCE((SELECT MAX("id") FROM "User"), 0), 1), true);
	ALTER TABLE "User" ALTER COLUMN "id" SET DEFAULT nextval('"User_id_seq"'::regclass);
	ALTER SEQUENCE "User_id_seq" OWNED BY "User"."id";
	
	ALTER TABLE "WorkbookEntry"
	  ALTER COLUMN "memberId" TYPE INTEGER USING "memberId"::integer;
	
	-- Create Quiz table and indexes if not present
	CREATE TABLE IF NOT EXISTS "Quiz" (
	    "id" SERIAL NOT NULL,
	    "moduleId" INTEGER NOT NULL,
	    "userId" INTEGER,
	    "question" TEXT NOT NULL,
	    "options" TEXT[],
	    "answer" TEXT NOT NULL,
	    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
	    "updatedAt" TIMESTAMP(3) NOT NULL,
	    CONSTRAINT "Quiz_pkey" PRIMARY KEY ("id")
	);
	
	CREATE INDEX IF NOT EXISTS "Quiz_moduleId_idx" ON "Quiz"("moduleId");
	CREATE INDEX IF NOT EXISTS "Quiz_userId_idx" ON "Quiz"("userId");
	CREATE UNIQUE INDEX IF NOT EXISTS "Quiz_moduleId_question_key" ON "Quiz"("moduleId", "question");
	CREATE UNIQUE INDEX IF NOT EXISTS "AcademyProgress_userId_moduleId_key" ON "AcademyProgress"("userId", "moduleId");
	CREATE UNIQUE INDEX IF NOT EXISTS "EventRsvp_eventId_userId_key" ON "EventRsvp"("eventId", "userId");
	CREATE INDEX IF NOT EXISTS "Message_senderId_idx" ON "Message"("senderId");
	CREATE INDEX IF NOT EXISTS "Message_receiverId_idx" ON "Message"("receiverId");
	CREATE UNIQUE INDEX IF NOT EXISTS "Profile_userId_key" ON "Profile"("userId");
	CREATE INDEX IF NOT EXISTS "Profile_mentorId_idx" ON "Profile"("mentorId");
	CREATE UNIQUE INDEX IF NOT EXISTS "Questionnaire_userId_key" ON "Questionnaire"("userId");
	CREATE UNIQUE INDEX IF NOT EXISTS "RegistryItem_externalId_userId_key" ON "RegistryItem"("externalId", "userId");
	CREATE UNIQUE INDEX IF NOT EXISTS "RegistryNote_registryItemId_mentorId_key" ON "RegistryNote"("registryItemId", "mentorId");
	CREATE UNIQUE INDEX IF NOT EXISTS "WorkbookEntry_memberId_moduleSlug_key" ON "WorkbookEntry"("memberId", "moduleSlug");
	
	-- Restore foreign keys
	ALTER TABLE "Profile" ADD CONSTRAINT "Profile_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Profile" ADD CONSTRAINT "Profile_mentorId_fkey" FOREIGN KEY ("mentorId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE;
	ALTER TABLE "Questionnaire" ADD CONSTRAINT "Questionnaire_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "AcademyProgress" ADD CONSTRAINT "AcademyProgress_moduleId_fkey" FOREIGN KEY ("moduleId") REFERENCES "AcademyModule"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "AcademyProgress" ADD CONSTRAINT "AcademyProgress_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Quiz" ADD CONSTRAINT "Quiz_moduleId_fkey" FOREIGN KEY ("moduleId") REFERENCES "AcademyModule"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Quiz" ADD CONSTRAINT "Quiz_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "RegistryItem" ADD CONSTRAINT "RegistryItem_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "RegistryNote" ADD CONSTRAINT "RegistryNote_mentorId_fkey" FOREIGN KEY ("mentorId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE;
	ALTER TABLE "CommunityPost" ADD CONSTRAINT "CommunityPost_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Comment" ADD CONSTRAINT "Comment_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Event" ADD CONSTRAINT "Event_createdById_fkey" FOREIGN KEY ("createdById") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "EventRsvp" ADD CONSTRAINT "EventRsvp_eventId_fkey" FOREIGN KEY ("eventId") REFERENCES "Event"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "EventRsvp" ADD CONSTRAINT "EventRsvp_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "WorkbookEntry" ADD CONSTRAINT "WorkbookEntry_memberId_fkey" FOREIGN KEY ("memberId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "WorkbookEntry" ADD CONSTRAINT "WorkbookEntry_moduleSlug_fkey" FOREIGN KEY ("moduleSlug") REFERENCES "AcademyModule"("slug") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Announcement" ADD CONSTRAINT "Announcement_authorId_fkey" FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Message" ADD CONSTRAINT "Message_senderId_fkey" FOREIGN KEY ("senderId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	ALTER TABLE "Message" ADD CONSTRAINT "Message_receiverId_fkey" FOREIGN KEY ("receiverId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
	
2025-11-06 07:41:25.028 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 07:41:25.030 MST [8857] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 1 recycled; write=0.001 s, sync=0.001 s, total=0.002 s; sync files=7, longest=0.001 s, average=0.001 s; distance=5081 kB, estimate=5081 kB; lsn=0/94497D0, redo lsn=0/9449798
2025-11-06 07:46:25.013 MST [8857] LOG:  checkpoint starting: time
2025-11-06 07:46:25.734 MST [8857] LOG:  checkpoint complete: wrote 8 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.717 s, sync=0.002 s, total=0.722 s; sync files=8, longest=0.001 s, average=0.001 s; distance=27 kB, estimate=4576 kB; lsn=0/94506C8, redo lsn=0/9450690
2025-11-06 08:07:34.600 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 08:07:34.605 MST [8857] LOG:  checkpoint complete: wrote 8 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.003 s, sync=0.001 s, total=0.005 s; sync files=8, longest=0.001 s, average=0.001 s; distance=4910 kB, estimate=4910 kB; lsn=0/991BF58, redo lsn=0/991BF20
2025-11-06 08:07:34.731 MST [8857] LOG:  checkpoint starting: immediate force wait
2025-11-06 08:07:34.732 MST [8857] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.001 s, sync=0.001 s, total=0.002 s; sync files=7, longest=0.001 s, average=0.001 s; distance=4913 kB, estimate=4913 kB; lsn=0/9DE8380, redo lsn=0/9DE8348
2025-11-06 08:12:34.730 MST [8857] LOG:  checkpoint starting: time
2025-11-06 08:12:52.085 MST [8857] LOG:  checkpoint complete: wrote 171 buffers (1.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=17.347 s, sync=0.007 s, total=17.356 s; sync files=94, longest=0.001 s, average=0.001 s; distance=759 kB, estimate=4497 kB; lsn=0/9EA61C8, redo lsn=0/9EA6190
2025-11-06 08:22:34.081 MST [8857] LOG:  checkpoint starting: time
2025-11-06 08:22:36.638 MST [8857] LOG:  checkpoint complete: wrote 26 buffers (0.2%); 0 WAL file(s) added, 0 removed, 0 recycled; write=2.547 s, sync=0.003 s, total=2.558 s; sync files=17, longest=0.001 s, average=0.001 s; distance=94 kB, estimate=4057 kB; lsn=0/9EBDCA0, redo lsn=0/9EBDC68
2025-11-06 08:27:34.644 MST [8857] LOG:  checkpoint starting: time
2025-11-06 08:27:34.751 MST [8857] LOG:  checkpoint complete: wrote 2 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.102 s, sync=0.001 s, total=0.108 s; sync files=2, longest=0.001 s, average=0.001 s; distance=3 kB, estimate=3652 kB; lsn=0/9EBEBD0, redo lsn=0/9EBEB98
2025-11-06 08:47:34.776 MST [8857] LOG:  checkpoint starting: time
2025-11-06 08:47:34.888 MST [8857] LOG:  checkpoint complete: wrote 2 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.104 s, sync=0.002 s, total=0.113 s; sync files=2, longest=0.001 s, average=0.001 s; distance=4 kB, estimate=3287 kB; lsn=0/9EBFC88, redo lsn=0/9EBFC50
2025-11-06 08:52:34.889 MST [8857] LOG:  checkpoint starting: time
2025-11-06 08:52:34.997 MST [8857] LOG:  checkpoint complete: wrote 2 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.103 s, sync=0.002 s, total=0.108 s; sync files=2, longest=0.001 s, average=0.001 s; distance=4 kB, estimate=2959 kB; lsn=0/9EC0FB0, redo lsn=0/9EC0F78
